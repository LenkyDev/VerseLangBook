# Test a recursive function.
fac_recursive(x:int):int=
    if(x <= 1) { return 1 }
    else { return x * fac_recursive(x - 1) }

assert{fac_recursive(1) = 1}
assert{fac_recursive(2) = 2}
assert{fac_recursive(3) = 6}
assert{fac_recursive(4) = 24}
assert{fac_recursive(5) = 120}

# Test a tail recursive function.
fac_tail_recursive(x:int, product:int):int=
    if(x <= 1) { return product }
    else { return fac_tail_recursive(x - 1, x * product) }

assert{fac_tail_recursive(1,1) = 1}
assert{fac_tail_recursive(2,1) = 2}
assert{fac_tail_recursive(3,1) = 6}
assert{fac_tail_recursive(4,1) = 24}
assert{fac_tail_recursive(5,1) = 120}

# Test a non-primitive recursive function (i.e. can't be translated to a loop).
ackermann(m:int, n:int):int=
    if(m = 0) { return n + 1 }
    else if(n = 0) { return ackermann(m - 1, 1) }
    else { return ackermann(m - 1, ackermann(m, n - 1)) }

assert{ackermann(0,0) = 1}
assert{ackermann(0,1) = 2}
assert{ackermann(0,2) = 3}
assert{ackermann(0,3) = 4}
assert{ackermann(0,4) = 5}
assert{ackermann(1,0) = 2}
assert{ackermann(1,1) = 3}
assert{ackermann(1,2) = 4}
assert{ackermann(1,3) = 5}
assert{ackermann(1,4) = 6}
assert{ackermann(2,0) = 3}
assert{ackermann(2,1) = 5}
assert{ackermann(2,2) = 7}
assert{ackermann(2,3) = 9}
assert{ackermann(2,4) = 11}
assert{ackermann(3,0) = 5}
assert{ackermann(3,1) = 13}
assert{ackermann(3,2) = 29}
assert{ackermann(3,3) = 61}
# Removed because recursion limit changed to 120
# assert{ackermann(3,4) = 125}
assert{ackermann(4,0) = 13}

# Test mutually recursive functions.
isEven(n:int):logic=
    if(n = 0) { return true }
    else { return isOdd(n-1) }
isOdd(n:int):logic=
    if(n = 0) { return false }
    else { return isEven(n-1) }

assert{isEven(0) = true}
assert{isOdd(0) = false}
assert{isEven(1) = false}
assert{isOdd(1) = true }
assert{isEven(2) = true}
assert{isOdd(2) = false}
assert{isEven(3) = false}
assert{isOdd(3) = true }
assert{isEven(4) = true}
assert{isOdd(4) = false}
assert{isEven(5) = false}
assert{isOdd(5) = true }
assert{isEven(6) = true}
assert{isOdd(6) = false}
assert{isEven(7) = false}
assert{isOdd(7) = true }
